<% if @activities.empty? %>
  <h4> No results found. </h4>
<% else %>
  <div class="activity-list">
    <% @activities.each do |activity| %>
      <div class="row activity-result">
        <div class="col-xs-12">
          <div class="col-xs-3">
            <div class="activity-preview">
              <%= link_to image_tag("bowling_lane", class: 'img-rounded img-fluid'), '/' %>
            </div>
          </div>
          <div class="col-xs-9">
            <%= form_tag(new_order_path, method: :get) do %>
              <div class="col-xs-9">
                <div class="activity-info">
                  <%= link_to "/", class: 'activity-name' do %>
                    <span class=''><%= activity.name %></span>
                  <% end %>
                  <% activity.reservables.active.each do |reservable| %>
                    <div class="reservable">
                      <span class="reservable-name"><%= reservable.name %></span>

                      <div class="row-times">
                        <% i = 0 %>
                        <% build_time_slots(reservable, @booking_date, @booking_time, current_user).each do |slot| %>
                          <%= button_tag(type: 'button', class: 'btn btn-danger timeslot ' +
                            ( activity.prevent_back_to_back_booking &&
                              ( slot[:booking_info][:booked_by] == current_user.id ) ?
                                'current-user-booked-slot' : '' ),
                            data: {
                              activity_id: activity.id,
                              reservable_id: reservable.id,
                              slot: i+=1
                            },
                            id: "timeslot-#{activity.id}-#{reservable.id}-#{i}",
                            disabled: !slot[:booking_info][:available]) do %>
                            <i class="fa"></i> <%= slot[:time].strftime("%H:%M") %>
                          <% end %>
                          <%= check_box_tag 'time_slots[' + reservable.id.to_s + '][]',
                            "#{slot[:time].strftime("%H:%M")},#{(slot[:time] +
                            reservable.interval.minutes).strftime("%H:%M")}",
                            false, class: 'checkbox-hidden',
                            id: "#{activity.id}-#{reservable.id}-#{i}" %>
                        <% end %>
                      </div>

                    </div>
                    <br/>
                  <% end %>
                </div>
              </div>

              <%= hidden_field_tag('date', @booking_date) %>
              <%= hidden_field_tag("prevent-btb-booking-#{activity.id}",
                activity.prevent_back_to_back_booking) %>
              <%= hidden_field_tag('activity_id', activity.id) %>
              <div class-"col-xs-3">
                <%= submit_tag 'Book', class: 'btn btn-info book-btn' %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>

<% end %>
